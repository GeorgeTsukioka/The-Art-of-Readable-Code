# 2章 名前に情報を詰め込む

## 2.7 まとめ
本章のテーマは<font color="Red">名前に情報を詰め込む</font>であった．つまり名前を見ただけで情報を読み取れるようにすること．

| まとめ | 内容 |
|:------------|:------------|
| 明確な単語を選ぶ | getのみではなく状況に応じてfetchやdownloadも使う |
| tmpやretvalなどの汎用的な名前を避ける | 明確な理由があればok |
| 具体的な名前を使って，物事を詳細に説明する | ServerCanStart()よりもCanListenOnPort()のほうが明確 |
| 変数名に大切な情報を追加する | ミリ秒を表す変数目には後ろにmsをつける |
| スコープの大きな変数には長い名前をつける | スコープが数画面に及ぶ，変に1~2文字の短い暗号のような変数名はだめ．短い名前はスコープが数行で使用する変数につける |
| 大文字やアンダースコアなどに意味を含める | クラスのメンバ変数に_をつけて，ローカル変数と区別する |

| KeyWord |
|:------------|
| 名前に情報を詰め込む |
| 気取った言い回しよりも明確で正確なほうがよい |

変数，関数，クラスでも名前はそれだけでも短いコメント（情報がある）

## 2.1 明確な単語を選ぶ
名前に情報を詰め込むには明確な単語を選ぶ必要がある．

getのようなものは明確ではない

```c
int Getpage()
{
  ...
}
```
Getpageからはなにも情報がない．どこから取ってきたものなのか．DB？キャッシュ？ネット？

ネットからデータを取得するのであれば，Fetchpage()とかDownloadpageとかにしたほうがわかりやすい．

```c
class BinaryTree{
  int size();
}
```
この場合の返り値は何を指しているのか．ツリーの深さ？ノード数？Sizeだけでは何も伝わらない．名前をつけるならNumNodeとか．

他にも何かを停止させる関数であったときに
```c
class Thread{
  void stop();
}
```
これは並列処理を停止させるだけ？killしないのかとかわからない．関数の役割に応じた名前をつけよう

### もっとカラフルな名前をつける
類似辞典を用いて，もっと良い名前がないか調べる．ただ，splitとexplodeは何かを分割させる意味だが，それの区別はつかない．

## 2.2 tmpやretvalなどの汎用的な名前を避ける
汎用的な変数名ではなく，<font color="Red">エンティティの値や目的を表した名前を使用する</font>

```c
int function (std::vector<int> cArray)
{
  int retval = 0;
  for(int i = 0; i < cArray.size(); ++i)
  {
    retval += cArray[i] * cArray[i];
  }
  return retval;
}
```

良い変数名=変数の目的や値を表すもの
だから今回の場合は，retval →　sun_squaresとかにすれば良い

<font color=Red>retvalという変数名には情報が無い．変数の値を表すような名前を使用する</font>

### tmp
汎用的な名前も使用方法をきちんとすれば良い

```c
if(right < left)
{
  tmp   = right;
  right = left;
  left  = tmp;
}
```
上記のような場合，tmpは本当に一時的なものとして保管される役割を持っているだけ．生存期間も短い．

つまり，今回のtmpは渡された値に「操作」をして変更しない点があげられる

次の例ではそれが行われていない．

```c
std::string tmp = user.name;
tmp += " " + user.phone;
tmp += " " + user.email;
std::cout << tmp << std::endl;
```
生存期間はさっきの例と同様に短いが，ここで必要なのは一時的な保存以外の役割を持っていること．tmp→user_infoとかにすれば，わかりやすい

```c
tmp_file = getFileName();
...
saveData(tmp_file);
```
上記のtmp_fileをtmpにすると，ファイル名なのかデータなのか見分けがつかない

<font color = Red>tmpという変数名は生存期間が短く（使用する行が短い），役割として一時的な保管がある場合のみだけ使用する</font>

### ループイテレータ
イテレータ等はiとかjとかkとかiterとかよく使われるものだが，バグの発見するのが困難になるときがある．
そのような場合は使用する配列の変数名の頭文字を使用すると良い

```c
for (int i = 0; i < clubs.size(); ++i)
 for (int j = 0; j < clubs[i].members.size(); ++j)
  for (int k = 0; k < users.size(); ++k)
   if(clubs[i].members[k] == users[j]) #iとjが逆
   std::cout << "user[" << j << "] はclub[" << i << "]" << std::endl;
```

実際にこれを実行するとインデックスが逆になっている．これを目視して確認するのは難しいため，以下のように変更する．

```c
if(clubs[i].members[k] == users[j])
```
→
```c
if(clubs[ci].members[ui] == users[mi])#バグですね
```
とすると一発で，何かがおかしいとわかる．
```c
if(clubs[ci].members[mi] == users[ui])#頭文字が同じ
```

### 汎用的な名前のまとめ
<font color=Red>tmp,it，retvalのような汎用的な名前を使用するときは，理由もきちんと考えよう</font>

日々，変数名をきちんと考える習慣をつけて，命名力を鍛えよう


## 2.3 抽象的な名前よりも具体的な名前を使う
ServerCanStartというTCP/IPポートのサーバがリッスンできるか確認するメソッドがあるとするが，少し抽象的である．「TCP/IPポートのサーバがリッスンできるか確認するメソッド」であるならば，CanListenOnPortのような動作をそのまま英語にするようなメソッド名にする．

### 例
--run_locallyというプログラムの実行時にデバッグ情報を印字するオプションだが，リモートで使用場合でもリモート側でデバッグ情報が欲しいときにオプションとしてつけて実行してしまう．

リモートなのにローカルのオプションを付けるという意味のわからないものになってしまう．

そのため，実際にこのオプション名はrun_locallyではなく，extra_loggerにしたほうがわかりやすい．
run_locallyにデバッグ以外の別の機能があった場合には，オプションを増やして「名前と目的」を分ける必要がある．

## 2.4 名前に情報を追加する
名前＝短いコメント

`
std::string  id//例:af84
`

とかの16進数の文字列を持つIDであるなら変数名をhex_idとかにすると変数名から型名がわかる．

### 値の単位
時間やバイト数のような計測できるものであれば，変数名に単位をいれて何が入っているのかわかりやすくすることができる．

```c
clock_t start = clock();
...
clock_t end = clock();
double time = (double)(end - start) / CLOCKS_PER_SEC;
std::cout << "duration = " << time << std::endl;
```

timeが何秒なのかわからない．それであれば，timeをtime_msにしておくと，不具合が見つかりやすい．

プログラミングで使用する単位は多い．仮引数とかもきちんと単位を持つものであれば，変数名に追加しておく．


### その他の重要な属性を追加する
時間の単位だけではなく，htmlの文字コードをutt-8に変更した場合の変数名をhtmlではなく，html_uft8にしたりすることでも使える．

基本的には変数の意味を理解してもらわなければならないと困る部分（処理）に属性や単位を追加しておく．

## 2.5 名前の長さを決める
変数名に情報を入れればよいが，長すぎるのは見る側，後で保守運用する側が困る．

変数名に決め方というのはきちんとガイドラインがある．

### スコープが小さければ短い名前でもいい
以下のようなif文のみで完結されるものであれば，前後に必要な情報がある．
```c
if(debug)
{
  std::map<std::string, int> m;
  LookUpNameNumbers(&m);
  Printf(m);
}
```
ただし，mがクラスのメンバ変数やグローバル変数である場合はmの型や目的がわからない．

スコープが大きければ大きいほど，名前に十分な情報を詰め込んで明確にしよう．

### 長い名前を入力するのは問題ではない
最近のエディタは優秀なのでtabとかで予測変換してくれる

### 頭文字と省略形
プロジェクト固有の省略形としてBackEndManagerをBEManagerとかにしてしまうが，これは後々参加してきたメンバーがわからない．

新しいメンバーがその名前を理解できるようなものであれば，省略してもよい．

他にも一般的なものであれば，省略しても良い．
* evaluation→eval
* string→str

### 不要な単語を投げ捨てる
なくても意味が伝わるようなものは削除しておく
* ConverttoString→ToString
* DoServeLoop→ServeLoop

## 2.6 名前のフォーマットで情報を伝える
コーディング規約を作ろうというお話．以下の例を挙げる．

```c
static const int kMaxOpenFiles = 100;

Class LogReader
{
public:
  void OpenFile(std::string local_file);;

private:
  int offset_;
  DISALLOW_COPY_AND_ASSION(LogReader);
}
```

* 定数には頭文字にkをつける
* メンバ変数には終文字に_をつける
* 引数はすべて小文字かつ単語間は_をつける

とかコーディング規約を設けることで処理を見たり，宣言を見て何かを特定するのではなく，名前から判別する．
